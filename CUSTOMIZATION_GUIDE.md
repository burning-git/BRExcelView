# BRExcelView Ëá™ÂÆö‰πâÊåáÂçó

ÂÆåÊï¥ÁöÑËá™ÂÆö‰πâÂäüËÉΩËØ¥ÊòéÔºåËÆ©‰Ω†ÁöÑË°®Ê†ºÁã¨‰∏ÄÊó†‰∫åÔºÅ

## üìã ÁõÆÂΩï

1. [ÂçïÂÖÉÊ†ºÁ∫ßÂà´Ëá™ÂÆö‰πâ](#ÂçïÂÖÉÊ†ºÁ∫ßÂà´Ëá™ÂÆö‰πâ)
2. [Ë°®Ê†ºÁ∫ßÂà´Ëá™ÂÆö‰πâ](#Ë°®Ê†ºÁ∫ßÂà´Ëá™ÂÆö‰πâ)
3. [È´òÁ∫ßËá™ÂÆö‰πâ](#È´òÁ∫ßËá™ÂÆö‰πâ)
4. [ÂÆåÊï¥Á§∫‰æã](#ÂÆåÊï¥Á§∫‰æã)

---

## ÂçïÂÖÉÊ†ºÁ∫ßÂà´Ëá™ÂÆö‰πâ

### 1. Âü∫Á°ÄÊ†∑Âºè

```swift
let cell = BRExcelCellModel(
    text: "Ëá™ÂÆö‰πâÂçïÂÖÉÊ†º",
    widthType: .fixed(120),
    textAlignment: .left,
    font: .boldSystemFont(ofSize: 16),
    textColor: .systemBlue,
    backgroundColor: .systemGray6
)
```

### 2. ËæπÊ°ÜÂíåÂúÜËßí

```swift
let cell = BRExcelCellModel(
    text: "ÂúÜËßíÂçïÂÖÉÊ†º",
    borderColor: .systemBlue,      // ËæπÊ°ÜÈ¢úËâ≤
    borderWidth: 2.0,               // ËæπÊ°ÜÂÆΩÂ∫¶
    cornerRadius: 8                 // ÂúÜËßíÂçäÂæÑ
)
```

### 3. ÂÜÖËæπË∑ù

```swift
let cell = BRExcelCellModel(
    text: "Ëá™ÂÆö‰πâÂÜÖËæπË∑ù",
    contentInsets: UIEdgeInsets(top: 12, left: 16, bottom: 12, right: 16)
)
```

### 4. ÂØåÊñáÊú¨

```swift
let attributedString = NSMutableAttributedString(string: "ÂØåÊñáÊú¨ÂÜÖÂÆπ")
attributedString.addAttribute(.foregroundColor, value: UIColor.red, range: NSRange(location: 0, length: 3))
attributedString.addAttribute(.font, value: UIFont.boldSystemFont(ofSize: 18), range: NSRange(location: 0, length: 3))

let cell = BRExcelCellModel(
    text: "",  // ‰ΩøÁî®ÂØåÊñáÊú¨Êó∂ text ÂèØ‰ª•‰∏∫Á©∫
    attributedText: attributedString
)
```

### 5. ÂÆåÂÖ®Ëá™ÂÆö‰πâËßÜÂõæ

```swift
// ÂàõÂª∫Ëá™ÂÆö‰πâËßÜÂõæ
let customView = UIStackView()
customView.axis = .horizontal
customView.spacing = 4

let imageView = UIImageView(image: UIImage(systemName: "star.fill"))
imageView.tintColor = .systemYellow
let label = UILabel()
label.text = "‚≠êÔ∏è 5.0"

customView.addArrangedSubview(imageView)
customView.addArrangedSubview(label)

// ‰ΩøÁî®Ëá™ÂÆö‰πâËßÜÂõæ
let cell = BRExcelCellModel(
    text: "",
    widthType: .fixed(100),
    customView: customView
)
```

---

## Ë°®Ê†ºÁ∫ßÂà´Ëá™ÂÆö‰πâ

### 1. Êï¥‰ΩìËæπÊ°ÜÂíåÂúÜËßí

```swift
let excelView = BRExcelView()

// Ë°®Ê†ºËæπÊ°Ü
excelView.tableBorderColor = .systemGray3
excelView.tableBorderWidth = 1

// Ë°®Ê†ºÂúÜËßí
excelView.tableCornerRadius = 12
```

### 2. ÂàÜÈöîÁ∫øÊ†∑Âºè

```swift
// ÊñπÂºè 1: ‰ΩøÁî®È¢ÑËÆæÊ†∑Âºè
excelView.separatorStyle = .default  // ÈªòËÆ§ÂàÜÈöîÁ∫ø
excelView.separatorStyle = .none     // Êó†ÂàÜÈöîÁ∫ø

// ÊñπÂºè 2: Ëá™ÂÆö‰πâÂàÜÈöîÁ∫ø
excelView.separatorStyle = BRExcelView.SeparatorStyle(
    color: .systemGray4,     // ÂàÜÈöîÁ∫øÈ¢úËâ≤
    width: 1.0,              // ÂàÜÈöîÁ∫øÂÆΩÂ∫¶
    showHorizontal: true,    // ÊòæÁ§∫Ê®™ÂêëÂàÜÈöîÁ∫ø
    showVertical: false      // ÈöêËóèÁ∫µÂêëÂàÜÈöîÁ∫ø
)
```

### 3. ÊªöÂä®ÈÖçÁΩÆ

```swift
// ÊòæÁ§∫ÊªöÂä®ÊåáÁ§∫Âô®
excelView.showsScrollIndicators = true

// ÊªöÂä®ÊåáÁ§∫Âô®È¢úËâ≤
excelView.scrollIndicatorColor = .black

// ÂêØÁî®ÂºπÊÄßÊªöÂä®
excelView.bounces = true
```

### 4. Â∞∫ÂØ∏ÈôêÂà∂

```swift
// ÊúÄÂ§ßÈ´òÂ∫¶ÔºàË∂ÖËøáÂàôÁ∫µÂêëÊªöÂä®Ôºâ
excelView.maxHeight = 400

// ÊúÄÂ§ßÂÆΩÂ∫¶ÔºàË∂ÖËøáÂàôÊ®™ÂêëÊªöÂä®Ôºâ
excelView.maxWidth = 600

// Ëá™Âä®Â°´ÂÖÖÂÆΩÂ∫¶
excelView.enableAutoFit = false  // ÂÜÖÂÆπÂÆΩÂ∫¶
excelView.enableAutoFit = true   // Â°´ÂÖÖËßÜÂõæÂÆΩÂ∫¶
```

---

## È´òÁ∫ßËá™ÂÆö‰πâ

### 1. Ê∑∑ÂêàÂàóÂÆΩÁ±ªÂûã

```swift
let columnWidthTypes: [BRExcelCellWidthType] = [
    .fixed(60),      // ID ÂàóÔºöÂõ∫ÂÆö 60px
    .auto,           // ÂßìÂêçÂàóÔºöÊ†πÊçÆÂÜÖÂÆπËá™ÈÄÇÂ∫î
    .flexible,       // ÊèèËø∞ÂàóÔºöÂºπÊÄßÂÆΩÂ∫¶ÔºåÂ°´ÂÖÖÂâ©‰ΩôÁ©∫Èó¥
    .fixed(100)      // Êìç‰ΩúÂàóÔºöÂõ∫ÂÆö 100px
]

excelView.setData(
    header: ["ID", "ÂßìÂêç", "ÊèèËø∞", "Êìç‰Ωú"],
    data: data,
    columnWidthTypes: columnWidthTypes
)
```

### 2. ‰∏çÂêåÈ£éÊ†ºÁöÑË°®Â§¥

```swift
let headerCells = [
    BRExcelCellModel(
        text: "‰∫ßÂìÅÂêçÁß∞",
        widthType: .fixed(150),
        font: .boldSystemFont(ofSize: 16),
        textColor: .white,
        backgroundColor: .systemBlue,
        borderColor: .clear,
        borderWidth: 0,
        cornerRadius: 0
    ),
    BRExcelCellModel(
        text: "‰ª∑Ê†º",
        widthType: .fixed(100),
        font: .boldSystemFont(ofSize: 16),
        textColor: .white,
        backgroundColor: .systemBlue
    )
]

let headerRow = BRExcelRowModel(cells: headerCells, height: 50, isHeader: true)
```

### 3. ÊñëÈ©¨Á∫πÊïàÊûú

```swift
var rows: [BRExcelRowModel] = []

// Ê∑ªÂä†Ë°®Â§¥
rows.append(headerRow)

// Ê∑ªÂä†Êï∞ÊçÆË°åÔºàÊñëÈ©¨Á∫πÔºâ
for (index, rowData) in data.enumerated() {
    let isEven = index % 2 == 0
    let bgColor: UIColor = isEven ? .white : .systemGray6
    
    let cells = rowData.map { text in
        BRExcelCellModel(
            text: text,
            backgroundColor: bgColor
        )
    }
    
    rows.append(BRExcelRowModel(cells: cells))
}

excelView.setData(rows: rows)
```

### 4. Â∏¶ÂõæÊ†áÁöÑÂçïÂÖÉÊ†º

```swift
// ÂàõÂª∫Â∏¶ÂõæÊ†áÁöÑËá™ÂÆö‰πâËßÜÂõæ
func createIconCell(icon: String, text: String) -> BRExcelCellModel {
    let container = UIStackView()
    container.axis = .horizontal
    container.spacing = 8
    container.alignment = .center
    
    let imageView = UIImageView(image: UIImage(systemName: icon))
    imageView.tintColor = .systemBlue
    imageView.contentMode = .scaleAspectFit
    imageView.widthAnchor.constraint(equalToConstant: 20).isActive = true
    imageView.heightAnchor.constraint(equalToConstant: 20).isActive = true
    
    let label = UILabel()
    label.text = text
    label.font = .systemFont(ofSize: 14)
    
    container.addArrangedSubview(imageView)
    container.addArrangedSubview(label)
    
    return BRExcelCellModel(
        text: "",
        widthType: .auto,
        customView: container
    )
}

// ‰ΩøÁî®
let cell = createIconCell(icon: "checkmark.circle.fill", text: "Â∑≤ÂÆåÊàê")
```

### 5. ÊåâÈíÆ/‰∫§‰∫íÂÖÉÁ¥†

```swift
// ÂàõÂª∫Â∏¶ÊåâÈíÆÁöÑÂçïÂÖÉÊ†º
func createButtonCell(title: String, action: @escaping () -> Void) -> BRExcelCellModel {
    let button = UIButton(type: .system)
    button.setTitle(title, for: .normal)
    button.addAction(UIAction { _ in action() }, for: .touchUpInside)
    
    return BRExcelCellModel(
        text: "",
        widthType: .fixed(80),
        customView: button,
        contentInsets: UIEdgeInsets(top: 4, left: 8, bottom: 4, right: 8)
    )
}

// ‰ΩøÁî®
let actionCell = createButtonCell(title: "Êü•Áúã") {
    print("ÊåâÈíÆË¢´ÁÇπÂáª‰∫ÜÔºÅ")
}
```

---

## ÂÆåÊï¥Á§∫‰æã

### Á§∫‰æã 1: Áé∞‰ª£ÂåñÂç°ÁâáÈ£éÊ†º

```swift
let excelView = BRExcelView()

// Ë°®Ê†ºÊï¥‰ΩìÊ†∑Âºè
excelView.tableBorderColor = .systemGray4
excelView.tableBorderWidth = 1
excelView.tableCornerRadius = 12
excelView.backgroundColor = .white
excelView.separatorStyle = BRExcelView.SeparatorStyle(
    color: .systemGray5,
    width: 1,
    showHorizontal: true,
    showVertical: false
)

var rows: [BRExcelRowModel] = []

// Áé∞‰ª£ÂåñË°®Â§¥
let headerCells = [
    BRExcelCellModel(
        text: "‰∫ßÂìÅ",
        widthType: .flexible,
        font: .boldSystemFont(ofSize: 16),
        textColor: .white,
        backgroundColor: .systemIndigo,
        borderWidth: 0
    ),
    BRExcelCellModel(
        text: "Áä∂ÊÄÅ",
        widthType: .fixed(100),
        font: .boldSystemFont(ofSize: 16),
        textColor: .white,
        backgroundColor: .systemIndigo,
        borderWidth: 0
    ),
    BRExcelCellModel(
        text: "‰ª∑Ê†º",
        widthType: .fixed(100),
        font: .boldSystemFont(ofSize: 16),
        textColor: .white,
        backgroundColor: .systemIndigo,
        borderWidth: 0
    )
]
rows.append(BRExcelRowModel(cells: headerCells, height: 50, isHeader: true))

// Êï∞ÊçÆË°å
rows.append(BRExcelRowModel(cells: [
    BRExcelCellModel(text: "iPhone 15 Pro", widthType: .flexible, textAlignment: .left),
    BRExcelCellModel(text: "‚úÖ Âú®ÂîÆ", widthType: .fixed(100)),
    BRExcelCellModel(text: "$999", widthType: .fixed(100), textColor: .systemGreen, font: .boldSystemFont(ofSize: 16))
], height: 44))

excelView.setData(rows: rows)
```

### Á§∫‰æã 2: ÊûÅÁÆÄÈ£éÊ†º

```swift
let excelView = BRExcelView()

// ÊûÅÁÆÄÊ†∑ÂºèÔºöÊó†ËæπÊ°ÜÔºåÂè™ÊúâÂàÜÈöîÁ∫ø
excelView.separatorStyle = BRExcelView.SeparatorStyle(
    color: .systemGray5,
    width: 1,
    showHorizontal: true,
    showVertical: false
)

// ÊâÄÊúâÂçïÂÖÉÊ†ºÊó†ËæπÊ°Ü
let cells = data.map { rowData in
    rowData.map { text in
        BRExcelCellModel(
            text: text,
            borderWidth: 0  // Êó†ËæπÊ°Ü
        )
    }
}
```

### Á§∫‰æã 3: È´ò‰∫ÆÈáçË¶ÅÊï∞ÊçÆ

```swift
// Ê†πÊçÆÊï∞ÂÄºÈ´ò‰∫ÆÊòæÁ§∫
func createHighlightCell(value: Int) -> BRExcelCellModel {
    let (color, bgColor): (UIColor, UIColor)
    
    if value >= 90 {
        color = .systemGreen
        bgColor = UIColor.systemGreen.withAlphaComponent(0.1)
    } else if value >= 60 {
        color = .systemOrange
        bgColor = UIColor.systemOrange.withAlphaComponent(0.1)
    } else {
        color = .systemRed
        bgColor = UIColor.systemRed.withAlphaComponent(0.1)
    }
    
    return BRExcelCellModel(
        text: "\(value)",
        textColor: color,
        backgroundColor: bgColor,
        borderColor: color,
        borderWidth: 1,
        cornerRadius: 4
    )
}
```

---

## üé® Ê†∑ÂºèÈ¢ÑËÆæ

‰∏∫Êñπ‰æø‰ΩøÁî®Ôºå‰Ω†ÂèØ‰ª•ÂàõÂª∫Ê†∑ÂºèÈ¢ÑËÆæÔºö

```swift
extension BRExcelCellModel {
    // Ë°®Â§¥Ê†∑Âºè
    static func header(text: String, width: BRExcelCellWidthType = .flexible) -> BRExcelCellModel {
        return BRExcelCellModel(
            text: text,
            widthType: width,
            font: .boldSystemFont(ofSize: 16),
            textColor: .white,
            backgroundColor: .systemBlue,
            borderWidth: 0
        )
    }
    
    // ÊôÆÈÄöÂçïÂÖÉÊ†ºÊ†∑Âºè
    static func normal(text: String, width: BRExcelCellWidthType = .auto) -> BRExcelCellModel {
        return BRExcelCellModel(
            text: text,
            widthType: width,
            borderColor: .systemGray5,
            borderWidth: 0.5
        )
    }
    
    // Âº∫Ë∞ÉÊ†∑Âºè
    static func emphasized(text: String, width: BRExcelCellWidthType = .auto) -> BRExcelCellModel {
        return BRExcelCellModel(
            text: text,
            widthType: width,
            font: .boldSystemFont(ofSize: 14),
            textColor: .systemBlue
        )
    }
}

// ‰ΩøÁî®È¢ÑËÆæ
let cell1 = BRExcelCellModel.header(text: "Ê†áÈ¢ò", width: .flexible)
let cell2 = BRExcelCellModel.normal(text: "ÂÜÖÂÆπ")
let cell3 = BRExcelCellModel.emphasized(text: "ÈáçË¶Å")
```

---

## üí° ÊúÄ‰Ω≥ÂÆûË∑µ

1. **ÊÄßËÉΩ‰ºòÂåñ**ÔºöÈÅøÂÖçÂú®ÂçïÂÖÉÊ†º‰∏≠‰ΩøÁî®Ëøá‰∫éÂ§çÊùÇÁöÑËá™ÂÆö‰πâËßÜÂõæ
2. **‰∏ÄËá¥ÊÄß**Ôºö‰øùÊåÅÁõ∏ÂêåÁ±ªÂûãÊï∞ÊçÆÁöÑÊ†∑Âºè‰∏ÄËá¥
3. **ÂèØËÆøÈóÆÊÄß**ÔºöÁ°Æ‰øùÊñáÊú¨È¢úËâ≤ÂíåËÉåÊôØËâ≤ÊúâË∂≥Â§üÁöÑÂØπÊØîÂ∫¶
4. **ÂìçÂ∫îÂºè**Ôºö‰ΩøÁî® `.flexible` ËÆ©Ë°®Ê†ºÈÄÇÂ∫î‰∏çÂêåÂ±èÂπïÂ∞∫ÂØ∏
5. **ÂàÜÂ±Ç**Ôºö‰ΩøÁî®ËæπÊ°ÜÂíåÈò¥ÂΩ±ÂàõÂª∫ËßÜËßâÂ±ÇÊ¨°

ÊÑâÂø´Âú∞ÂÆöÂà∂‰Ω†ÁöÑË°®Ê†ºÔºÅüéâ
