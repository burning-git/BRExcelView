# Ëá™ÂÆö‰πâË°åËßÜÂõæÂÆåÊï¥ÊåáÂçó

BRExcelView ÊîØÊåÅÂÆåÂÖ®Ëá™ÂÆö‰πâÊï¥Ë°åÁöÑÊòæÁ§∫ÔºåËÆ©‰Ω†ÂèØ‰ª•ÂàõÂª∫‰ªªÊÑèÂ§çÊùÇÁöÑË°åÂ∏ÉÂ±Ä„ÄÇ

## üìã ÁõÆÂΩï

1. [Âü∫Á°ÄÁî®Ê≥ï](#Âü∫Á°ÄÁî®Ê≥ï)
2. [ÂÆûÁé∞ÂçèËÆÆ](#ÂÆûÁé∞ÂçèËÆÆ)
3. [ÂÆåÊï¥Á§∫‰æã](#ÂÆåÊï¥Á§∫‰æã)
4. [È´òÁ∫ßÊäÄÂ∑ß](#È´òÁ∫ßÊäÄÂ∑ß)

---

## Âü∫Á°ÄÁî®Ê≥ï

### ÊñπÂºè 1: ÂÆûÁé∞ÂçèËÆÆ

ÂàõÂª∫‰∏Ä‰∏™ÈÅµÂæ™ `BRExcelCustomRowView` ÂçèËÆÆÁöÑËá™ÂÆö‰πâËßÜÂõæÔºö

```swift
import BRExcelView

class MyCustomRowView: UIView, BRExcelCustomRowView {
    
    private let titleLabel = UILabel()
    private let subtitleLabel = UILabel()
    private let iconView = UIImageView()
    
    override init(frame: CGRect) {
        super.init(frame: frame)
        setupUI()
    }
    
    required init?(coder: NSCoder) {
        super.init(coder: coder)
        setupUI()
    }
    
    private func setupUI() {
        // Â∏ÉÂ±Ä‰Ω†ÁöÑËá™ÂÆö‰πâËßÜÂõæ
        addSubview(iconView)
        addSubview(titleLabel)
        addSubview(subtitleLabel)
        
        // ËÆæÁΩÆÁ∫¶Êùü...
    }
    
    // ÂÆûÁé∞ÂçèËÆÆÊñπÊ≥ï
    func configure(with model: BRExcelRowModel, columnWidths: [CGFloat]) {
        // Ê†πÊçÆ model ÈÖçÁΩÆËßÜÂõæ
        if model.cells.count > 0 {
            titleLabel.text = model.cells[0].text
        }
        if model.cells.count > 1 {
            subtitleLabel.text = model.cells[1].text
        }
    }
}
```

### ‰ΩøÁî®Ëá™ÂÆö‰πâË°åËßÜÂõæ

```swift
// ÂàõÂª∫Ë°åÊï∞ÊçÆ
let customRow = BRExcelRowModel(
    cells: [
        BRExcelCellModel(text: "Ê†áÈ¢ò"),
        BRExcelCellModel(text: "ÂâØÊ†áÈ¢ò")
    ],
    height: 80,
    customRowViewType: MyCustomRowView.self
)

var rows: [BRExcelRowModel] = []
rows.append(customRow)

excelView.setData(rows: rows)
```

---

## ÊñπÂºè 2: ‰ΩøÁî®ÈÖçÁΩÆÈó≠ÂåÖ

Â¶ÇÊûú‰∏çÊÉ≥ÂàõÂª∫Êñ∞Á±ªÔºåÂèØ‰ª•‰ΩøÁî®ÈÖçÁΩÆÈó≠ÂåÖÔºö

```swift
// ÂàõÂª∫‰∏Ä‰∏™ÈÄöÁî®ÁöÑËá™ÂÆö‰πâËßÜÂõæÁ±ª
class GenericCustomRowView: UIView, BRExcelCustomRowView {
    let containerStack = UIStackView()
    
    override init(frame: CGRect) {
        super.init(frame: frame)
        containerStack.axis = .horizontal
        containerStack.spacing = 8
        containerStack.translatesAutoresizingMaskIntoConstraints = false
        addSubview(containerStack)
        
        NSLayoutConstraint.activate([
            containerStack.topAnchor.constraint(equalTo: topAnchor),
            containerStack.bottomAnchor.constraint(equalTo: bottomAnchor),
            containerStack.leadingAnchor.constraint(equalTo: leadingAnchor, constant: 16),
            containerStack.trailingAnchor.constraint(equalTo: trailingAnchor, constant: -16)
        ])
    }
    
    required init?(coder: NSCoder) {
        fatalError("init(coder:) has not been implemented")
    }
    
    func configure(with model: BRExcelRowModel, columnWidths: [CGFloat]) {
        // ÈªòËÆ§ÂÆûÁé∞ÔºåÂèØ‰ª•Ë¢´Èó≠ÂåÖË¶ÜÁõñ
    }
}

// ‰ΩøÁî®ÈÖçÁΩÆÈó≠ÂåÖ
let customRow = BRExcelRowModel(
    cells: [BRExcelCellModel(text: "Êï∞ÊçÆ")],
    height: 60,
    customRowViewType: GenericCustomRowView.self,
    customRowViewConfiguration: { view, model, columnWidths in
        guard let customView = view as? GenericCustomRowView else { return }
        
        // Ëá™ÂÆö‰πâÈÖçÁΩÆ
        let imageView = UIImageView(image: UIImage(systemName: "star.fill"))
        imageView.tintColor = .systemYellow
        
        let label = UILabel()
        label.text = model.cells.first?.text
        label.font = .boldSystemFont(ofSize: 16)
        
        customView.containerStack.addArrangedSubview(imageView)
        customView.containerStack.addArrangedSubview(label)
    }
)
```

---

## ÂÆåÊï¥Á§∫‰æã

### Á§∫‰æã 1: Âç°ÁâáÂºèË°åËßÜÂõæ

```swift
class CardRowView: UIView, BRExcelCustomRowView {
    
    private let cardContainer = UIView()
    private let titleLabel = UILabel()
    private let subtitleLabel = UILabel()
    private let statusBadge = UILabel()
    private let chevronIcon = UIImageView()
    
    override init(frame: CGRect) {
        super.init(frame: frame)
        setupUI()
    }
    
    required init?(coder: NSCoder) {
        super.init(coder: coder)
        setupUI()
    }
    
    private func setupUI() {
        // Âç°ÁâáÂÆπÂô®
        cardContainer.backgroundColor = .white
        cardContainer.layer.cornerRadius = 12
        cardContainer.layer.shadowColor = UIColor.black.cgColor
        cardContainer.layer.shadowOpacity = 0.1
        cardContainer.layer.shadowOffset = CGSize(width: 0, height: 2)
        cardContainer.layer.shadowRadius = 4
        cardContainer.translatesAutoresizingMaskIntoConstraints = false
        addSubview(cardContainer)
        
        // Ê†áÈ¢ò
        titleLabel.font = .boldSystemFont(ofSize: 16)
        titleLabel.translatesAutoresizingMaskIntoConstraints = false
        cardContainer.addSubview(titleLabel)
        
        // ÂâØÊ†áÈ¢ò
        subtitleLabel.font = .systemFont(ofSize: 14)
        subtitleLabel.textColor = .systemGray
        subtitleLabel.translatesAutoresizingMaskIntoConstraints = false
        cardContainer.addSubview(subtitleLabel)
        
        // Áä∂ÊÄÅÂæΩÁ´†
        statusBadge.font = .systemFont(ofSize: 12)
        statusBadge.textAlignment = .center
        statusBadge.layer.cornerRadius = 4
        statusBadge.clipsToBounds = true
        statusBadge.translatesAutoresizingMaskIntoConstraints = false
        cardContainer.addSubview(statusBadge)
        
        // ÁÆ≠Â§¥ÂõæÊ†á
        chevronIcon.image = UIImage(systemName: "chevron.right")
        chevronIcon.tintColor = .systemGray3
        chevronIcon.translatesAutoresizingMaskIntoConstraints = false
        cardContainer.addSubview(chevronIcon)
        
        // Á∫¶Êùü
        NSLayoutConstraint.activate([
            cardContainer.topAnchor.constraint(equalTo: topAnchor, constant: 4),
            cardContainer.bottomAnchor.constraint(equalTo: bottomAnchor, constant: -4),
            cardContainer.leadingAnchor.constraint(equalTo: leadingAnchor, constant: 8),
            cardContainer.trailingAnchor.constraint(equalTo: trailingAnchor, constant: -8),
            
            titleLabel.topAnchor.constraint(equalTo: cardContainer.topAnchor, constant: 12),
            titleLabel.leadingAnchor.constraint(equalTo: cardContainer.leadingAnchor, constant: 16),
            titleLabel.trailingAnchor.constraint(lessThanOrEqualTo: statusBadge.leadingAnchor, constant: -8),
            
            subtitleLabel.topAnchor.constraint(equalTo: titleLabel.bottomAnchor, constant: 4),
            subtitleLabel.leadingAnchor.constraint(equalTo: titleLabel.leadingAnchor),
            subtitleLabel.trailingAnchor.constraint(lessThanOrEqualTo: statusBadge.leadingAnchor, constant: -8),
            
            statusBadge.centerYAnchor.constraint(equalTo: cardContainer.centerYAnchor),
            statusBadge.trailingAnchor.constraint(equalTo: chevronIcon.leadingAnchor, constant: -12),
            statusBadge.widthAnchor.constraint(greaterThanOrEqualToConstant: 60),
            statusBadge.heightAnchor.constraint(equalToConstant: 24),
            
            chevronIcon.centerYAnchor.constraint(equalTo: cardContainer.centerYAnchor),
            chevronIcon.trailingAnchor.constraint(equalTo: cardContainer.trailingAnchor, constant: -16),
            chevronIcon.widthAnchor.constraint(equalToConstant: 12),
            chevronIcon.heightAnchor.constraint(equalToConstant: 20)
        ])
    }
    
    func configure(with model: BRExcelRowModel, columnWidths: [CGFloat]) {
        guard model.cells.count >= 3 else { return }
        
        titleLabel.text = model.cells[0].text
        subtitleLabel.text = model.cells[1].text
        
        // Áä∂ÊÄÅÈÖçÁΩÆ
        let status = model.cells[2].text
        statusBadge.text = status
        
        switch status {
        case "Â∑≤ÂÆåÊàê":
            statusBadge.backgroundColor = UIColor.systemGreen.withAlphaComponent(0.2)
            statusBadge.textColor = .systemGreen
        case "ËøõË°å‰∏≠":
            statusBadge.backgroundColor = UIColor.systemOrange.withAlphaComponent(0.2)
            statusBadge.textColor = .systemOrange
        default:
            statusBadge.backgroundColor = UIColor.systemGray.withAlphaComponent(0.2)
            statusBadge.textColor = .systemGray
        }
    }
}

// ‰ΩøÁî®
let cardRow = BRExcelRowModel(
    cells: [
        BRExcelCellModel(text: "È°πÁõÆ A"),
        BRExcelCellModel(text: "Êà™Ê≠¢Êó•ÊúüÔºö2024-12-31"),
        BRExcelCellModel(text: "ËøõË°å‰∏≠")
    ],
    height: 80,
    customRowViewType: CardRowView.self
)
```

### Á§∫‰æã 2: ÂèØ‰∫§‰∫íÁöÑË°åËßÜÂõæ

```swift
class InteractiveRowView: UIView, BRExcelCustomRowView {
    
    private let titleLabel = UILabel()
    private let actionButton = UIButton(type: .system)
    private let switchControl = UISwitch()
    
    var onButtonTap: (() -> Void)?
    var onSwitchToggle: ((Bool) -> Void)?
    
    override init(frame: CGRect) {
        super.init(frame: frame)
        setupUI()
    }
    
    required init?(coder: NSCoder) {
        super.init(coder: coder)
        setupUI()
    }
    
    private func setupUI() {
        backgroundColor = .white
        
        titleLabel.font = .systemFont(ofSize: 16)
        titleLabel.translatesAutoresizingMaskIntoConstraints = false
        addSubview(titleLabel)
        
        actionButton.setTitle("Êìç‰Ωú", for: .normal)
        actionButton.addTarget(self, action: #selector(buttonTapped), for: .touchUpInside)
        actionButton.translatesAutoresizingMaskIntoConstraints = false
        addSubview(actionButton)
        
        switchControl.addTarget(self, action: #selector(switchToggled), for: .valueChanged)
        switchControl.translatesAutoresizingMaskIntoConstraints = false
        addSubview(switchControl)
        
        NSLayoutConstraint.activate([
            titleLabel.centerYAnchor.constraint(equalTo: centerYAnchor),
            titleLabel.leadingAnchor.constraint(equalTo: leadingAnchor, constant: 16),
            
            switchControl.centerYAnchor.constraint(equalTo: centerYAnchor),
            switchControl.trailingAnchor.constraint(equalTo: trailingAnchor, constant: -16),
            
            actionButton.centerYAnchor.constraint(equalTo: centerYAnchor),
            actionButton.trailingAnchor.constraint(equalTo: switchControl.leadingAnchor, constant: -16)
        ])
    }
    
    func configure(with model: BRExcelRowModel, columnWidths: [CGFloat]) {
        if let text = model.cells.first?.text {
            titleLabel.text = text
        }
    }
    
    @objc private func buttonTapped() {
        onButtonTap?()
    }
    
    @objc private func switchToggled() {
        onSwitchToggle?(switchControl.isOn)
    }
}

// ‰ΩøÁî®
let interactiveRow = BRExcelRowModel(
    cells: [BRExcelCellModel(text: "ÂêØÁî®ÈÄöÁü•")],
    height: 50,
    customRowViewType: InteractiveRowView.self,
    customRowViewConfiguration: { view, model, _ in
        guard let interactiveView = view as? InteractiveRowView else { return }
        
        interactiveView.onButtonTap = {
            print("ÊåâÈíÆË¢´ÁÇπÂáª")
        }
        
        interactiveView.onSwitchToggle = { isOn in
            print("ÂºÄÂÖ≥Áä∂ÊÄÅ: \(isOn)")
        }
    }
)
```

### Á§∫‰æã 3: ËøõÂ∫¶Êù°Ë°åËßÜÂõæ

```swift
class ProgressRowView: UIView, BRExcelCustomRowView {
    
    private let nameLabel = UILabel()
    private let progressView = UIProgressView(progressViewStyle: .default)
    private let percentLabel = UILabel()
    
    override init(frame: CGRect) {
        super.init(frame: frame)
        setupUI()
    }
    
    required init?(coder: NSCoder) {
        super.init(coder: coder)
        setupUI()
    }
    
    private func setupUI() {
        nameLabel.font = .systemFont(ofSize: 14)
        nameLabel.translatesAutoresizingMaskIntoConstraints = false
        addSubview(nameLabel)
        
        progressView.translatesAutoresizingMaskIntoConstraints = false
        addSubview(progressView)
        
        percentLabel.font = .systemFont(ofSize: 12)
        percentLabel.textColor = .systemGray
        percentLabel.translatesAutoresizingMaskIntoConstraints = false
        addSubview(percentLabel)
        
        NSLayoutConstraint.activate([
            nameLabel.topAnchor.constraint(equalTo: topAnchor, constant: 8),
            nameLabel.leadingAnchor.constraint(equalTo: leadingAnchor, constant: 16),
            nameLabel.trailingAnchor.constraint(lessThanOrEqualTo: trailingAnchor, constant: -16),
            
            progressView.topAnchor.constraint(equalTo: nameLabel.bottomAnchor, constant: 8),
            progressView.leadingAnchor.constraint(equalTo: leadingAnchor, constant: 16),
            progressView.trailingAnchor.constraint(equalTo: percentLabel.leadingAnchor, constant: -8),
            
            percentLabel.centerYAnchor.constraint(equalTo: progressView.centerYAnchor),
            percentLabel.trailingAnchor.constraint(equalTo: trailingAnchor, constant: -16),
            percentLabel.widthAnchor.constraint(equalToConstant: 40)
        ])
    }
    
    func configure(with model: BRExcelRowModel, columnWidths: [CGFloat]) {
        guard model.cells.count >= 2 else { return }
        
        nameLabel.text = model.cells[0].text
        
        if let progressValue = Float(model.cells[1].text) {
            let progress = progressValue / 100.0
            progressView.progress = progress
            percentLabel.text = "\(Int(progressValue))%"
            
            // Ê†πÊçÆËøõÂ∫¶ËÆæÁΩÆÈ¢úËâ≤
            if progress >= 0.8 {
                progressView.progressTintColor = .systemGreen
            } else if progress >= 0.5 {
                progressView.progressTintColor = .systemOrange
            } else {
                progressView.progressTintColor = .systemRed
            }
        }
    }
}

// ‰ΩøÁî®
let progressRow = BRExcelRowModel(
    cells: [
        BRExcelCellModel(text: "È°πÁõÆÂÆåÊàêÂ∫¶"),
        BRExcelCellModel(text: "75")
    ],
    height: 60,
    customRowViewType: ProgressRowView.self
)
```

---

## È´òÁ∫ßÊäÄÂ∑ß

### 1. Ê∑∑Âêà‰ΩøÁî®ÈªòËÆ§Ë°åÂíåËá™ÂÆö‰πâË°å

```swift
var rows: [BRExcelRowModel] = []

// ÈªòËÆ§Ë°®Â§¥
rows.append(BRExcelRowModel(
    cells: headerCells,
    isHeader: true
))

// Ëá™ÂÆö‰πâË°å
rows.append(BRExcelRowModel(
    cells: [BRExcelCellModel(text: "ÁâπÊÆäË°å")],
    height: 80,
    customRowViewType: CardRowView.self
))

// ÊôÆÈÄöË°å
rows.append(BRExcelRowModel(
    cells: normalCells
))

excelView.setData(rows: rows)
```

### 2. ÂìçÂ∫îÂàóÂÆΩÂèòÂåñ

```swift
func configure(with model: BRExcelRowModel, columnWidths: [CGFloat]) {
    // ‰ΩøÁî®ÂàóÂÆΩ‰ø°ÊÅØÊù•Ë∞ÉÊï¥Â∏ÉÂ±Ä
    if columnWidths.count > 0 {
        titleLabel.widthAnchor.constraint(equalToConstant: columnWidths[0]).isActive = true
    }
}
```

### 3. ËÆøÈóÆË°åÊï∞ÊçÆÁöÑÊâÄÊúâ‰ø°ÊÅØ

```swift
func configure(with model: BRExcelRowModel, columnWidths: [CGFloat]) {
    // ËÆøÈóÆÂçïÂÖÉÊ†ºÊ®°ÂûãÁöÑÊâÄÊúâÂ±ûÊÄß
    for (index, cell) in model.cells.enumerated() {
        print("Cell \(index):")
        print("  Text: \(cell.text)")
        print("  Color: \(cell.backgroundColor)")
        print("  Font: \(cell.font)")
        
        // ‰ΩøÁî®ÂØåÊñáÊú¨
        if let attributedText = cell.attributedText {
            // Â§ÑÁêÜÂØåÊñáÊú¨
        }
        
        // ‰ΩøÁî®Ëá™ÂÆö‰πâËßÜÂõæ
        if let customView = cell.customView {
            // Â§ÑÁêÜËá™ÂÆö‰πâËßÜÂõæ
        }
    }
}
```

---

## üéØ ÊúÄ‰Ω≥ÂÆûË∑µ

1. **ÊÄßËÉΩ**ÔºöÈÅøÂÖçÂú® `configure` ÊñπÊ≥ï‰∏≠ÂàõÂª∫Â§çÊùÇÁöÑËßÜÂõæÂ±ÇÊ¨°ÔºåÂú® `init` ‰∏≠ÂÆåÊàêÂ∏ÉÂ±Ä
2. **Â§çÁî®**ÔºöÂàõÂª∫ÂèØÂ§çÁî®ÁöÑËá™ÂÆö‰πâË°åËßÜÂõæÁ±ª
3. **‰∏ÄËá¥ÊÄß**Ôºö‰øùÊåÅËá™ÂÆö‰πâË°å‰∏éË°®Ê†ºÂÖ∂‰ªñÈÉ®ÂàÜÁöÑËßÜËßâ‰∏ÄËá¥ÊÄß
4. **ÂìçÂ∫îÂºè**ÔºöÂà©Áî® `columnWidths` ÂèÇÊï∞ÂÆûÁé∞ÂìçÂ∫îÂºèÂ∏ÉÂ±Ä
5. **Êï∞ÊçÆÈ©±Âä®**ÔºöËÆ© `BRExcelRowModel` È©±Âä®ËßÜÂõæÁä∂ÊÄÅÔºåËÄå‰∏çÊòØÁ°¨ÁºñÁ†Å

‰∫´ÂèóÂÆåÂÖ®Ëá™ÂÆö‰πâÁöÑÁÅµÊ¥ªÊÄßÔºÅüé®
