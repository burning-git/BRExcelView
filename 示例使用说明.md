# 🎯 BRExcelView 自定义行视图示例使用说明

## ✅ 已创建的示例文件

我已经在 `Examples/` 文件夹中创建了 **3 个完整的示例文件**，包含 **13 个不同的使用场景**！

### 📁 文件列表

```
Examples/
├── README.md                      # 📖 示例索引和使用指南
├── QuickStartGuide.swift         # ⭐ 6个快速入门示例（推荐新手）
├── CustomRowViewExamples.swift   # 🎨 4个精美自定义行视图
└── RealWorldExamples.swift       # 🏢 3个真实业务场景
```

---

## 🚀 快速开始

### 步骤 1: 选择你想要的示例

#### 🟢 如果你是新手，推荐从这里开始：

**打开 `Examples/QuickStartGuide.swift`**

里面有 6 个从简单到复杂的示例：

```swift
// 示例 1: 最简单（3 行代码）
example1_SimpleTable(in: excelView)

// 示例 2: 配置列宽
example2_ColumnWidths(in: excelView)

// 示例 3: 自定义样式
example3_CustomStyle(in: excelView)

// 示例 4: 第一个自定义行视图
example4_CustomRowView(in: excelView)

// 示例 5: 可交互的行
example5_InteractiveRow(in: excelView)

// 示例 6: 混合使用（推荐）
example6_MixedContent(in: excelView)
```

#### 🟡 如果你想看精美的 UI 设计：

**打开 `Examples/CustomRowViewExamples.swift`**

包含 4 个生产级别的自定义行视图：
- 任务卡片（带阴影、彩色指示器、徽章）
- 进度条（动态颜色、图标、百分比）
- 可交互行（开关、按钮、副标题）
- 用户卡片（头像、徽章、箭头）

#### 🔴 如果你想看实际应用场景：

**打开 `Examples/RealWorldExamples.swift`**

包含 3 个完整的业务场景：
- 成绩单系统
- 电商订单列表
- 项目进度跟踪

---

### 步骤 2: 在项目中使用示例

有 **3 种方法** 使用这些示例：

#### 方法 1: 在 ViewController.swift 中直接调用（最简单）⭐

1. 打开 `BRExcelView/ViewController.swift`

2. 在 `loadSampleData()` 方法中添加：

```swift
private func loadSampleData() {
    // 调用快速示例
    example6_MixedContent(in: excelView)
}
```

3. 将示例函数复制到 ViewController 中（或者直接导入示例文件）

4. 运行项目即可看到效果！

#### 方法 2: 创建新的 ViewController

1. 复制 `Examples/QuickStartGuide.swift` 中的 `DemoViewController`

2. 在 `SceneDelegate.swift` 中设置为根视图：

```swift
func scene(_ scene: UIScene, willConnectTo session: UISceneSession, options connectionOptions: UIScene.ConnectionOptions) {
    guard let windowScene = (scene as? UIWindowScene) else { return }
    
    window = UIWindow(windowScene: windowScene)
    window?.rootViewController = DemoViewController()  // ← 使用示例 VC
    window?.makeKeyAndVisible()
}
```

3. 运行项目

#### 方法 3: 复制完整的自定义行视图类

1. 从示例文件中复制你喜欢的自定义行视图类

2. 粘贴到你的项目中

3. 在你的代码中使用：

```swift
let row = BRExcelRowModel(
    cells: [...],
    height: 80,
    customRowViewType: TaskCardRowView.self  // ← 使用复制的类
)
```

---

## 📚 示例详细说明

### 1️⃣ QuickStartGuide.swift

**包含示例：**

| 示例 | 难度 | 代码行数 | 说明 |
|------|------|---------|------|
| example1 | ⭐ | 5 行 | 最简单的表格，3 行代码创建 |
| example2 | ⭐ | 10 行 | 配置列宽（固定/自适应/弹性）|
| example3 | ⭐⭐ | 20 行 | 自定义颜色、字体、样式 |
| example4 | ⭐⭐ | 15 行 | 第一个自定义行视图 |
| example5 | ⭐⭐ | 20 行 | 可交互行（开关、回调）|
| example6 | ⭐⭐⭐ | 30 行 | 混合使用多种类型 |

**自定义行视图类：**
- `SimpleCardView` - 简单卡片（50 行代码）
- `SimpleProgressView` - 简单进度条（40 行代码）
- `SettingRowView` - 设置行（50 行代码）

**适合：**
- ✅ 第一次使用 BRExcelView
- ✅ 快速了解基本功能
- ✅ 学习自定义行视图的基础

---

### 2️⃣ CustomRowViewExamples.swift

**包含示例：**

| 自定义视图 | 行数 | 特点 |
|-----------|------|------|
| TaskCardRowView | 150 行 | 卡片阴影、优先级指示器、状态徽章 |
| ProgressRowView | 120 行 | 动态颜色、状态图标、圆角进度条 |
| InteractiveRowView | 100 行 | 开关、按钮、图标、副标题 |
| UserCardRowView | 130 行 | 圆形头像、VIP 徽章、箭头 |

**特点：**
- ✅ 生产级别的 UI 设计
- ✅ 完整的自动布局约束
- ✅ 丰富的视觉效果
- ✅ 可直接用于实际项目

**适合：**
- ✅ 学习高级 UI 设计
- ✅ 理解复杂布局
- ✅ 参考实际项目实现

---

### 3️⃣ RealWorldExamples.swift

**包含场景：**

| 场景 | ViewController | 说明 | 行数 |
|------|---------------|------|------|
| 成绩单 | ScoreCardViewController | 标准表格展示 | 80 行 |
| 订单列表 | OrderListViewController | 卡片式订单、点击交互 | 200 行 |
| 项目跟踪 | ProjectTrackerViewController | 进度条、负责人信息 | 180 行 |

**自定义视图：**
- `OrderCardView` - 订单卡片（150 行）
- `ProjectProgressView` - 项目进度（100 行）

**特点：**
- ✅ 真实业务场景
- ✅ 完整的 ViewController
- ✅ 复杂数据处理
- ✅ 专业交互设计

**适合：**
- ✅ 实际项目开发
- ✅ 学习完整实现
- ✅ 参考业务逻辑

---

## 🎨 如何自定义

### 修改现有示例

1. **改变颜色**
```swift
backgroundColor: .systemBlue  // 改成你喜欢的颜色
```

2. **调整字体**
```swift
font: .boldSystemFont(ofSize: 18)  // 改变大小和粗细
```

3. **修改布局**
```swift
height: 100  // 调整行高
```

### 创建自己的自定义视图

参考示例文件中的模板：

```swift
class MyCustomRow: UIView, BRExcelCustomRowView {
    // 1. 声明 UI 元素
    private let titleLabel = UILabel()
    
    // 2. 初始化
    override init(frame: CGRect) {
        super.init(frame: frame)
        setupUI()
    }
    
    required init?(coder: NSCoder) {
        fatalError("init(coder:) has not been implemented")
    }
    
    // 3. 设置 UI
    private func setupUI() {
        // 添加视图
        addSubview(titleLabel)
        
        // 设置约束
        titleLabel.translatesAutoresizingMaskIntoConstraints = false
        NSLayoutConstraint.activate([
            titleLabel.centerYAnchor.constraint(equalTo: centerYAnchor),
            titleLabel.leadingAnchor.constraint(equalTo: leadingAnchor, constant: 16)
        ])
    }
    
    // 4. 配置数据
    func configure(with model: BRExcelRowModel, columnWidths: [CGFloat]) {
        titleLabel.text = model.cells[0].text
    }
}
```

---

## 💡 使用技巧

### 1. 调试技巧

在 `configure` 方法中添加打印：

```swift
func configure(with model: BRExcelRowModel, columnWidths: [CGFloat]) {
    print("配置行: \(model.cells.map { $0.text })")
    // 你的代码...
}
```

### 2. 性能优化

- 避免在 `configure` 中创建新视图
- 复用已有的 UI 元素
- 使用 `layer.shouldRasterize` 优化复杂视图

### 3. 响应式布局

使用相对约束而不是固定值：

```swift
// 好 ✅
widthAnchor.constraint(equalTo: superview.widthAnchor, multiplier: 0.5)

// 避免 ❌
widthAnchor.constraint(equalToConstant: 100)
```

---

## 📊 对比表

| 特性 | 简单示例 | 自定义视图示例 | 真实场景 |
|------|---------|--------------|---------|
| 代码复杂度 | ⭐ | ⭐⭐ | ⭐⭐⭐ |
| UI 精美度 | ⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ |
| 学习价值 | ⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ |
| 可直接使用 | ✅ | ✅ | ✅ |
| 包含交互 | 部分 | ✅ | ✅ |
| 完整场景 | ❌ | 部分 | ✅ |

---

## 🎯 学习建议

### Day 1: 基础入门
1. 运行 `example1_SimpleTable`
2. 运行 `example2_ColumnWidths`
3. 运行 `example3_CustomStyle`
4. 理解基本概念

### Day 2: 自定义视图
1. 运行 `example4_CustomRowView`
2. 研究 `SimpleCardView` 的实现
3. 尝试修改颜色和布局
4. 创建自己的简单视图

### Day 3: 高级特性
1. 运行 `example5_InteractiveRow`
2. 运行 `example6_MixedContent`
3. 学习交互回调
4. 组合多种视图类型

### Day 4: 实战应用
1. 研究 `RealWorldExamples.swift`
2. 选择一个场景深入学习
3. 根据自己的需求定制
4. 应用到实际项目

---

## 🆘 常见问题

### Q: 示例文件在哪里？
**A**: 在 `Examples/` 文件夹中，有 4 个文件。

### Q: 可以直接复制使用吗？
**A**: 可以！所有示例都是完整可运行的代码。

### Q: 需要添加 Package 吗？
**A**: 是的，需要先按照 `HOW_TO_USE_PACKAGE.md` 添加 Package。

### Q: 示例代码报错怎么办？
**A**: 
1. 确认已添加 BRExcelView Package
2. 确认文件顶部有 `import BRExcelView`
3. 清理项目并重新编译（Cmd + Shift + K）

### Q: 如何修改示例？
**A**: 直接修改代码即可，所有参数都可以自定义。

---

## 📖 更多资源

- **示例索引**: `Examples/README.md` ⭐
- **基础文档**: `README.md`
- **自定义指南**: `CUSTOM_ROW_VIEW_GUIDE.md`
- **快速参考**: `QUICK_REFERENCE.md`
- **问题排查**: `TROUBLESHOOTING.md`

---

## 🎉 开始使用

1. **现在就打开** `Examples/QuickStartGuide.swift`
2. **选择一个示例** 运行看看效果
3. **阅读代码** 理解实现原理
4. **修改参数** 看看会发生什么
5. **创建自己的** 自定义行视图

**祝你使用愉快！** 🚀

有任何问题，欢迎查看文档或提 issue！
